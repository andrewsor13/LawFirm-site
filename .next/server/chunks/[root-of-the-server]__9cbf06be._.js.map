{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreisorin/Desktop/ProjectsInProgress/LawFirm-site/src/lib/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n\nexport const supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey, {\n  auth: {\n    autoRefreshToken: false,\n    persistSession: false,\n  },\n});\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM;AACN,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;AAEzD,MAAM,gBAAgB,CAAA,GAAA,yLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,oBAAoB;IACzE,MAAM;QACJ,kBAAkB;QAClB,gBAAgB;IAClB;AACF","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreisorin/Desktop/ProjectsInProgress/LawFirm-site/src/lib/auth.ts"],"sourcesContent":["import CredentialsProvider from \"next-auth/providers/credentials\";\nimport { supabaseAdmin } from \"./supabaseAdmin\";\nimport { NextAuthOptions, DefaultSession } from \"next-auth\";\nimport { compare } from \"bcryptjs\";\n\ndeclare module \"next-auth\" {\n  interface Session {\n    user: {\n      id: string;\n      role: string;\n    } & DefaultSession[\"user\"];\n  }\n\n  interface JWT {\n    id: string;\n    role: string;\n  }\n}\n\nexport const authOptions: NextAuthOptions = {\n  providers: [\n    CredentialsProvider({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"text\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (!credentials) return null;\n\n        const email = credentials.email.toLowerCase();\n        const password = credentials.password;\n\n        console.log(\"üîë Login attempt:\", { email, password });\n\n        const { data, error } = await supabaseAdmin\n          .from(\"admin_users\")\n          .select(\"*\")\n          .eq(\"email\", email)\n          .single();\n\n        console.log(\"üóÇ Supabase result:\", { data, error });\n\n        if (error || !data) {\n          console.log(\"‚ùå User not found in DB\");\n          return null;\n        }\n\n        const isValid = await compare(password, data.password);\n        console.log(\"üîê Compare result:\", isValid);\n\n        if (!isValid) {\n          console.log(\"‚ùå Invalid password for user:\", data.email);\n          return null;\n        }\n\n        console.log(\"‚úÖ Authorized user:\", data.email);\n        return {\n          id: data.id,\n          email: data.email,\n          role: data.role,\n          name: data.name,\n        };\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (token?.id) {\n        session.user.id = token.id;\n        session.user.role = token.role;\n      }\n      return session;\n    },\n\n    redirect: async ({ url, baseUrl }) => {\n      if (url.startsWith(baseUrl)) return url;\n      if (url.startsWith(\"/\")) return `${baseUrl}${url}`;\n      return baseUrl;\n    },\n  },\n  pages: {\n    signIn: \"/login\",\n  },\n  session: {\n    strategy: \"jwt\",\n  },\n};\n"],"names":[],"mappings":";;;AAAA;AACA;AAEA;;;;AAgBO,MAAM,cAA+B;IAC1C,WAAW;QACT,CAAA,GAAA,0JAAA,CAAA,UAAmB,AAAD,EAAE;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAO;gBACtC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,OAAO;gBAEzB,MAAM,QAAQ,YAAY,KAAK,CAAC,WAAW;gBAC3C,MAAM,WAAW,YAAY,QAAQ;gBAErC,QAAQ,GAAG,CAAC,qBAAqB;oBAAE;oBAAO;gBAAS;gBAEnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6HAAA,CAAA,gBAAa,CACxC,IAAI,CAAC,eACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,OACZ,MAAM;gBAET,QAAQ,GAAG,CAAC,uBAAuB;oBAAE;oBAAM;gBAAM;gBAEjD,IAAI,SAAS,CAAC,MAAM;oBAClB,QAAQ,GAAG,CAAC;oBACZ,OAAO;gBACT;gBAEA,MAAM,UAAU,MAAM,CAAA,GAAA,mIAAA,CAAA,UAAO,AAAD,EAAE,UAAU,KAAK,QAAQ;gBACrD,QAAQ,GAAG,CAAC,sBAAsB;gBAElC,IAAI,CAAC,SAAS;oBACZ,QAAQ,GAAG,CAAC,gCAAgC,KAAK,KAAK;oBACtD,OAAO;gBACT;gBAEA,QAAQ,GAAG,CAAC,sBAAsB,KAAK,KAAK;gBAC5C,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,OAAO,IAAI;gBACb,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;QAEA,UAAU,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE;YAC/B,IAAI,IAAI,UAAU,CAAC,UAAU,OAAO;YACpC,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO,GAAG,UAAU,KAAK;YAClD,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;IACA,SAAS;QACP,UAAU;IACZ;AACF","debugId":null}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreisorin/Desktop/ProjectsInProgress/LawFirm-site/src/lib/prisma.tsx"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log:\n      process.env.NODE_ENV === \"development\"\n        ? [\"query\", \"error\", \"warn\"]\n        : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n\nprocess.on(\"beforeExit\", async () => {\n  await prisma.$disconnect();\n});\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6HAAA,CAAA,eAAY,CAAC;IACf,KACE,uCACI;QAAC;QAAS;QAAS;KAAO;AAElC;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B;AAEA,QAAQ,EAAE,CAAC,cAAc;IACvB,MAAM,OAAO,WAAW;AAC1B","debugId":null}},
    {"offset": {"line": 316, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreisorin/Desktop/ProjectsInProgress/LawFirm-site/src/app/api/faq/route.ts"],"sourcesContent":["import { authOptions } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/prisma\";\nimport { getServerSession } from \"next-auth\";\nimport { NextRequest, NextResponse } from \"next/server\";\nimport slugify from \"slugify\";\n\nexport async function GET(req: NextRequest) {\n  try {\n    const { searchParams } = new URL(req.url);\n    const publishedParam = searchParams.get(\"published\");\n\n    const where =\n      publishedParam === \"true\"\n        ? { isPublished: true }\n        : publishedParam === \"false\"\n        ? { isPublished: false }\n        : {};\n\n    const faqs = await prisma.faq.findMany({\n      where,\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return NextResponse.json(faqs);\n  } catch (error) {\n    console.error(\"GET /api/faq error:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch FAQs\" },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function POST(req: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    return NextResponse.json({ error: \"Neautorizat\" }, { status: 401 });\n  }\n\n  if (session.user.role !== \"admin\") {\n    return NextResponse.json({ error: \"Acces restric»õionat\" }, { status: 403 });\n  }\n\n  try {\n    const body = await req.json();\n    const { author, email, question, html, text, domainId } = body;\n\n    if (!question) {\n      return NextResponse.json(\n        { error: \"Question is required\" },\n        { status: 400 }\n      );\n    }\n\n    const baseSlug = slugify(question, { lower: true, strict: true });\n\n    const existingSlug = await prisma.faq.findUnique({\n      where: { slug: baseSlug },\n    });\n    if (existingSlug) {\n      return NextResponse.json(\n        { error: \"A FAQ with a similar question already exists\" },\n        { status: 400 }\n      );\n    }\n\n    const existingQuestion = await prisma.faq.findFirst({\n      where: { question },\n    });\n    if (existingQuestion) {\n      return NextResponse.json(\n        { error: \"This question already exists\" },\n        { status: 400 }\n      );\n    }\n\n    const faq = await prisma.faq.create({\n      data: {\n        question,\n        slug: baseSlug,\n        html: html || null,\n        text: text || \"\",\n        author: author || null,\n        email: email || null,\n        ...(domainId ? { domain: { connect: { id: domainId } } } : {}),\n        isPublished: Boolean(html?.trim() || text?.trim()),\n      },\n    });\n\n    return NextResponse.json({ success: true, faq });\n  } catch (error: unknown) {\n    console.error(\"POST /api/faq error:\", error);\n    const message = error instanceof Error ? error.message : \"Unknown error\";\n    return NextResponse.json({ error: message }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}